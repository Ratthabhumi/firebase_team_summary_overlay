<!DOCTYPE html>
<html lang="en" style="background: transparent;">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Rugby Team Summary Overlay</title>
<style>
  body {
    margin: 0; padding: 10px;
    font-family: sans-serif;
    background: transparent;
    color: white;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    background-color: rgba(0,0,0,0.6);
    font-size: 1.2em;
  }
  th, td {
    border: 1px solid white;
    padding: 8px;
    text-align: center;
  }
</style>
</head>
<body>

<table>
  <thead>
    <tr>
      <th>Team</th><th>Tries</th><th>Conversions</th><th>Penalty Goals</th><th>Drop Goals</th><th>Total Pts</th><th>Possession %</th><th>Territory Avg (km)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Team A</td>
      <td id="a-tries">-</td>
      <td id="a-conv">-</td>
      <td id="a-pen">-</td>
      <td id="a-drop">-</td>
      <td id="a-total">-</td>
      <td id="a-possession">-</td>
      <td id="a-territory">-</td>
    </tr>
    <tr>
      <td>Team B</td>
      <td id="b-tries">-</td>
      <td id="b-conv">-</td>
      <td id="b-pen">-</td>
      <td id="b-drop">-</td>
      <td id="b-total">-</td>
      <td id="b-possession">-</td>
      <td id="b-territory">-</td>
    </tr>
  </tbody>
</table>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAxU5xfTf8wRTnkmTHP7pR3Aon7IISRvyY",
    authDomain: "rugby-c8da2.firebaseapp.com",
    databaseURL: "https://rugby-c8da2-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "rugby-c8da2",
    storageBucket: "rugby-c8da2.firebasestorage.app",
    messagingSenderId: "812436187599",
    appId: "1:812436187599:web:4dd147d1b35c2122c08aba",
    measurementId: "G-07W3W2VZND"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const summaryRef = ref(db, 'summary');

  onValue(summaryRef, (snapshot) => {
    const data = snapshot.val();
    if (!data) return;

    function updateCell(id, val) {
      document.getElementById(id).textContent = val ?? '-';
    }

    ['a','b'].forEach(team => {
      updateCell(team + '-tries', data[team]?.tries);
      updateCell(team + '-conv', data[team]?.conv);
      updateCell(team + '-pen', data[team]?.pen);
      updateCell(team + '-drop', data[team]?.drop);
      updateCell(team + '-possession', data[team]?.possession + '%');
      updateCell(team + '-territory', data[team]?.territory);

      // คำนวณคะแนนรวม
      const tries = data[team]?.tries || 0;
      const conv = data[team]?.conv || 0;
      const pen = data[team]?.pen || 0;
      const drop = data[team]?.drop || 0;
      const total = tries*5 + conv*2 + (pen + drop)*3;
      updateCell(team + '-total', total);
    });
  });
</script>

</body>
</html>
